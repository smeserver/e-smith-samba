Index: e-smith-samba/e-smith-samba.spec
diff -u /dev/null e-smith-samba/root/etc/e-smith/db/configuration/defaults/smb/UnixCharSet:1.1
--- /dev/null	Mon Jul 18 13:39:48 2005
+++ e-smith-samba/root/etc/e-smith/db/configuration/defaults/smb/UnixCharSet	Mon Jul 18 13:39:00 2005
@@ -0,0 +1 @@
+UTF8
Index: e-smith-samba/root/etc/e-smith/db/configuration/migrate/20smb
diff -u e-smith-samba/root/etc/e-smith/db/configuration/migrate/20smb:1.1 e-smith-samba/root/etc/e-smith/db/configuration/migrate/20smb:1.2
--- e-smith-samba/root/etc/e-smith/db/configuration/migrate/20smb:1.1	Thu Feb 17 17:11:34 2005
+++ e-smith-samba/root/etc/e-smith/db/configuration/migrate/20smb	Mon Jul 18 13:39:00 2005
@@ -1,6 +1,6 @@
 {
     my $smb = $DB->get('smb') ||
-		$DB->new_record("smb");;
+		$DB->new_record("smb");
 
     my %new_props = ();
 
@@ -30,6 +30,11 @@
 	$new_props{UnixCharSet} = $ClientCodePage;
         $smb->delete_prop('ClientCodePage');
     }
-    
+   
+    if ($smb->prop('status') and not $smb->prop('UnixCharSet'))
+    {
+	$new_props{UnixCharSet} ||= 'ISO8859-1';
+    }
+ 
     $smb->merge_props(%new_props);
 }
Index: e-smith-samba/root/etc/e-smith/templates/etc/smb.conf/11unixCharSet
diff -u e-smith-samba/root/etc/e-smith/templates/etc/smb.conf/11unixCharSet:1.1 e-smith-samba/root/etc/e-smith/templates/etc/smb.conf/11unixCharSet:1.2
--- e-smith-samba/root/etc/e-smith/templates/etc/smb.conf/11unixCharSet:1.1	Thu Feb 17 18:04:02 2005
+++ e-smith-samba/root/etc/e-smith/templates/etc/smb.conf/11unixCharSet	Mon Jul 18 13:39:00 2005
@@ -1,5 +1,5 @@
 {
-    my $UnixCharSet = $smb{'UnixCharSet'} || "ISO8859-1";
+    my $UnixCharSet = $smb{'UnixCharSet'} || "UTF8";
 
     "unix charset = $UnixCharSet";
 }
